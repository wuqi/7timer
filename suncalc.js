(function(){var v=Math.PI,a=Math.sin,c=Math.cos,A=Math.tan,p=Math.asin,l=Math.atan2,s=Math.acos,E=v/180;var C=1000*60*60*24,g=2440588,H=2451545;function w(e){return e.valueOf()/C-0.5+g}function D(e){return new Date((e+0.5-g)*C)}function k(e){return w(e)-H}var B=E*23.4397;function h(J,e){return l(a(J)*c(B)-A(e)*a(B),c(J))}function q(J,e){return p(a(e)*c(B)+c(e)*a(B)*a(J))}function x(e,J,K){return l(a(e),c(e)*a(J)-A(K)*c(J))}function m(e,J,K){return p(a(J)*a(K)+c(J)*c(K)*c(e))}function y(J,e){return E*(280.16+360.9856235*J)-e}function j(e){if(e<0){e=0}return 0.0002967/Math.tan(e+0.00312536/(e+0.08901179))}function G(e){return E*(357.5291+0.98560028*e)}function u(K){var J=E*(1.9148*a(K)+0.02*a(2*K)+0.0003*a(3*K)),e=E*102.9372;return K+J+e+v}function z(J){var K=G(J),e=u(K);return{dec:q(e,0),ra:h(e,0)}}var i={};i.getPosition=function(J,N,e){var M=E*-e,L=E*N,O=k(J),P=z(O),K=y(O,M)-P.ra;return{azimuth:x(K,L,P.dec),altitude:m(K,L,P.dec)}};var o=i.times=[[-0.833,"sunrise","sunset"],[-0.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];i.addTime=function(J,K,e){o.push([J,K,e])};var f=0.0009;function t(J,e){return Math.round(J-f-e/(2*v))}function r(e,J,K){return f+(e+J)/(2*v)+K}function d(J,K,e){return H+J+0.0053*a(K)-0.0069*a(2*e)}function F(e,J,K){return s((a(e)-a(J)*a(K))/(c(J)*c(K)))}function n(N,J,O,K,e,P,Q){var S=F(N,O,K),R=r(S,J,e);return d(R,P,Q)}i.getTimes=function(aa,K,ab){var J=E*-ab,e=E*K,Y=k(aa),U=t(Y,J),T=r(0,J,U),O=G(T),P=u(O),S=q(P,0),Z=d(T,O,P),W,X,N,R,V;var Q={solarNoon:D(Z),nadir:D(Z-0.5)};for(W=0,X=o.length;W<X;W+=1){N=o[W];R=n(N[0]*E,J,e,S,U,O,P);V=Z-(R-Z);Q[N[1]]=D(V);Q[N[2]]=D(R)}return Q};function I(P){var J=E*(218.316+13.176396*P),Q=E*(134.963+13.064993*P),O=E*(93.272+13.22935*P),K=J+E*6.289*a(Q),e=E*5.128*a(O),N=385001-20905*c(Q);return{ra:h(K,e),dec:q(K,e),dist:N}}i.getMoonPosition=function(J,O,P){var e=E*-P,L=E*O,M=k(J),N=I(M),R=y(M,e)-N.ra,K=m(R,L,N.dec),Q=l(a(R),A(L)*c(N.dec)-a(N.dec)*c(R));K=K+j(K);return{azimuth:x(R,L,N.dec),altitude:K,distance:N.dist,parallacticAngle:Q}};i.getMoonIllumination=function(J){var P=k(J),K=z(P),e=I(P),M=149598000,L=s(a(K.dec)*a(e.dec)+c(K.dec)*c(e.dec)*c(K.ra-e.ra)),N=l(M*a(L),e.dist-M*c(L)),O=l(c(K.dec)*a(K.ra-e.ra),a(K.dec)*c(e.dec)-c(K.dec)*a(e.dec)*c(K.ra-e.ra));return{fraction:(1+c(N))/2,phase:0.5+0.5*N*(O<0?-1:1)/Math.PI,angle:O}};function b(e,J){return new Date(e.valueOf()+J*C/24)}i.getMoonTimes=function(aa,K,ad,P){var T=new Date(aa);if(P){T.setUTCHours(0,0,0,0)}else{T.setHours(0,0,0,0)}var L=0.133*E,Q=i.getMoonPosition(T,K,ad).altitude-L,O,N,J,U,ac,ab,V,e,Z,M,Y,X,S;for(var W=1;W<=24;W+=2){O=i.getMoonPosition(b(T,W),K,ad).altitude-L;N=i.getMoonPosition(b(T,W+1),K,ad).altitude-L;ac=(Q+N)/2-O;ab=(N-Q)/2;V=-ab/(2*ac);e=(ac*V+ab)*V+O;Z=ab*ab-4*ac*O;M=0;if(Z>=0){S=Math.sqrt(Z)/(Math.abs(ac)*2);Y=V-S;X=V+S;if(Math.abs(Y)<=1){M++}if(Math.abs(X)<=1){M++}if(Y<-1){Y=X}}if(M===1){if(Q<0){J=W+Y}else{U=W+Y}}else{if(M===2){J=W+(e<0?X:Y);U=W+(e<0?Y:X)}}if(J&&U){break}Q=N}var R={};if(J){R.rise=b(T,J)}if(U){R.set=b(T,U)}if(!J&&!U){R[e>0?"alwaysUp":"alwaysDown"]=true}return R};i.getGalaxyPosition=function(J,O,P){var e=E*-P,L=E*O,M=k(J),N={dec:-28.9333333*E,ra:266.5*E},Q=y(M,e)-N.ra,K=m(Q,L,N.dec);K=K+j(K);return{azimuth:x(Q,L,N.dec),altitude:K}};i.getGalaxyTimes=function(aa,K,ad,P){var T=new Date(aa);if(P){T.setUTCHours(0,0,0,0)}else{T.setHours(0,0,0,0)}var L=0.133*E,Q=i.getGalaxyPosition(T,K,ad).altitude-L,O,N,J,U,ac,ab,V,e,Z,M,Y,X,S;for(var W=1;W<=24;W+=2){O=i.getGalaxyPosition(b(T,W),K,ad).altitude-L;N=i.getGalaxyPosition(b(T,W+1),K,ad).altitude-L;ac=(Q+N)/2-O;ab=(N-Q)/2;V=-ab/(2*ac);e=(ac*V+ab)*V+O;Z=ab*ab-4*ac*O;M=0;if(Z>=0){S=Math.sqrt(Z)/(Math.abs(ac)*2);Y=V-S;X=V+S;if(Math.abs(Y)<=1){M++}if(Math.abs(X)<=1){M++}if(Y<-1){Y=X}}if(M===1){if(Q<0){J=W+Y}else{U=W+Y}}else{if(M===2){J=W+(e<0?X:Y);U=W+(e<0?Y:X)}}if(J&&U){break}Q=N}var R={};if(J){R.rise=b(T,J)}if(U){R.set=b(T,U)}if(J&&U){if(J<U){R.mid=b(T,(J+U)/2)}else{R.mid=b(T,(24+J+U)/2);R.set=b(T,(24+U))}}if(!J&&!U){R[e>0?"alwaysUp":"alwaysDown"]=true}return R};if(typeof define==="function"&&define.amd){define(i)}else{if(typeof module!=="undefined"){module.exports=i}else{window.SunCalc=i}}}());
